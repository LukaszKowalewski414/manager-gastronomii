{% extends 'base.html' %}

{% block content %}
<div class="container my-5">
    <h2 class="text-center mb-4 text-primary">Edytuj rozliczenie dzienne ({{ data }})</h2>

    <!-- FORMULARZ EDYCJI -->
    <form method="POST" action="{{ url_for('edit_daily', data=data) }}">
        <h5>Przychody</h5>
        {% for field in ['bar', 'kuchnia', 'wejsciowki', 'inne'] %}
        <div class="form-check mb-3">
            {% set val = roz['sprzedaz_' + field] %}
            <input class="form-check-input" type="checkbox" id="sprzedaz_{{ field }}" name="sprzedaz_{{ field }}" {% if val %}checked{% endif %}>
            <label class="form-check-label" for="sprzedaz_{{ field }}">Sprzeda≈º {{ field }}</label>
            <input type="number" step="0.01" class="form-control mt-1" name="sprzedaz_{{ field }}_kwota" value="{{ val or '' }}" placeholder="Kwota (z≈Ç)">
        </div>
        {% endfor %}

        <hr>
        <h5>Koszty</h5>

<!-- BAR -->
<div class="form-check mb-3">
    {% set val = roz['koszt_bar'] %}
    <input class="form-check-input" type="checkbox" id="koszt_bar" name="koszt_bar" {% if val %}checked{% endif %}>
    <label class="form-check-label" for="koszt_bar">Obs≈Çuga bar</label>
    <input type="number" step="0.01" class="form-control mt-1" name="koszt_bar_kwota" value="{{ val or '' }}" placeholder="Kwota (z≈Ç)">
    <input type="number" class="form-control mt-1" name="staff_bar" min="0" value="{{ roz.staff_bar or '' }}" placeholder="Liczba pracownik√≥w ‚Äì bar">
</div>

<!-- KELNERZY -->
<div class="form-check mb-3">
    {% set val = roz['koszt_kelnerzy'] %}
    <input class="form-check-input" type="checkbox" id="koszt_kelnerzy" name="koszt_kelnerzy" {% if val %}checked{% endif %}>
    <label class="form-check-label" for="koszt_kelnerzy">Obs≈Çuga kelnerska</label>
    <input type="number" step="0.01" class="form-control mt-1" name="koszt_kelnerzy_kwota" value="{{ val or '' }}" placeholder="Kwota (z≈Ç)">
    <input type="number" class="form-control mt-1" name="staff_waiters" min="0" value="{{ roz.staff_waiters or '' }}" placeholder="Liczba pracownik√≥w ‚Äì kelnerzy">
</div>

<!-- KUCHNIA -->
<div class="form-check mb-3">
    {% set val = roz['koszt_kuchnia'] %}
    <input class="form-check-input" type="checkbox" id="koszt_kuchnia" name="koszt_kuchnia" {% if val %}checked{% endif %}>
    <label class="form-check-label" for="koszt_kuchnia">Obs≈Çuga kuchni</label>
    <input type="number" step="0.01" class="form-control mt-1" name="koszt_kuchnia_kwota" value="{{ val or '' }}" placeholder="Kwota (z≈Ç)">
    <input type="number" class="form-control mt-1" name="staff_kitchen" min="0" value="{{ roz.staff_kitchen or '' }}" placeholder="Liczba pracownik√≥w ‚Äì kuchnia">
</div>

<!-- OCHRONA -->
<div class="form-check mb-3">
    {% set val = roz['koszt_ochrona'] %}
    <input class="form-check-input" type="checkbox" id="koszt_ochrona" name="koszt_ochrona" {% if val %}checked{% endif %}>
    <label class="form-check-label" for="koszt_ochrona">Ochrona</label>
    <input type="number" step="0.01" class="form-control mt-1" name="koszt_ochrona_kwota" value="{{ val or '' }}" placeholder="Kwota (z≈Ç)">
    <input type="number" class="form-control mt-1" name="staff_security" min="0" value="{{ roz.staff_security or '' }}" placeholder="Liczba pracownik√≥w ‚Äì ochrona">
</div>

    </form>

 <hr>
<h5>Notatka</h5>
<textarea class="form-control mb-3" name="notatka" rows="4" placeholder="Mo≈ºesz tu dopisaƒá dowolne informacje...">{{ roz['notatka'] }}</textarea>


    <!-- FORMULARZ USUWANIA -->
    <form method="POST" action="{{ url_for('delete_daily', data=data) }}" onsubmit="return confirm('Czy na pewno chcesz usunƒÖƒá rozliczenie dnia?');">
        <div class="text-center mt-3">
            <button type="submit" class="btn border border-dark text-dark">
    üóëÔ∏è Usu≈Ñ rozliczenie
</button>

        </div>
    </form>
</div>

<!-- JS: pokazywanie p√≥l przy zaznaczaniu checkbox√≥w -->
<script>
document.addEventListener('DOMContentLoaded', function () {
    const checkboxes = document.querySelectorAll('.form-check-input');

    checkboxes.forEach(function (checkbox) {
        toggleRelatedFields(checkbox);
        checkbox.addEventListener('change', function () {
            toggleRelatedFields(checkbox);
        });
    });

    function toggleRelatedFields(checkbox) {
        const container = checkbox.closest('.form-check');
        const inputs = container.querySelectorAll('.form-control');
        inputs.forEach(input => {
            input.style.display = checkbox.checked ? 'block' : 'none';
        });
    }
});
</script>
{% endblock %}
